meta {
  name: Command Injection Test
  type: http
  seq: 3
}

get {
  url: {{baseUrl}}/api/{{apiVersion}}/users?cmd=;cat /etc/passwd
  body: none
  auth: none
}

headers {
  Content-Type: application/json
  Accept: application/json
}

tests {
  test("Command injection blocked by WAF", function() {
    // WAF should block OS command injection
    expect(res.status).to.be.oneOf([400, 403]);
  });
}

docs {
  # Command Injection Test

  This request tests that the BIG-IP WAF blocks OS command injection attempts.

  ## Attack Vector
  Command injection: `;cat /etc/passwd`

  ## Expected Behavior
  - BIG-IP ASM should detect and block the command injection
  - Response should be 403 Forbidden or 400 Bad Request
  - Request should appear in ASM logs with Command Execution violation

  ## Verification
  1. Check BIG-IP: Security > Event Logs > Application > Requests
  2. Look for violation: Command Execution
}
